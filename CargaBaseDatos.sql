USE CmiSellOutEcuador;

TRUNCATE TABLE BASE_INICIAL_VENTAS;

BULK INSERT BASE_INICIAL_VENTAS
FROM 'C:\Proyectos\Ecuador\CMI_SellOut_Ecuador\BaseDatos\BDPRUEBAVENTAS.csv'
WITH (FIELDTERMINATOR=';',FIRSTROW=2,CODEPAGE='ACP');

UPDATE A SET Agencia = TRIM(Agencia) FROM BASE_INICIAL_VENTAS A;
UPDATE A SET CodArticulo = TRIM(CodArticulo) FROM BASE_INICIAL_VENTAS A;
UPDATE A SET GrupoProducto = TRIM(GrupoProducto) FROM BASE_INICIAL_VENTAS A;
UPDATE A SET CodAlicorp = TRIM(CodAlicorp) FROM BASE_INICIAL_VENTAS A;
UPDATE A SET DesArticulo = TRIM(DesArticulo) FROM BASE_INICIAL_VENTAS A;

UPDATE BASE_INICIAL_VENTAS
	SET CodAlicorp = CASE CodArticulo
	WHEN '8005777' THEN '8312006'
	WHEN '8005653' THEN '3300123'
	ELSE CodAlicorp	END

UPDATE BASE_INICIAL_VENTAS
	SET CodAlicorp = CASE DesArticulo
	WHEN 'NUTREG BOLSA SURTIDA 200G 20BO'	THEN	'4335049'
	WHEN 'NUTREG BOLSA SURTIDA 400G 12BO'	THEN	'4335048'
	ELSE CodAlicorp END

UPDATE BASE_INICIAL_VENTAS
	SET	CodArticulo = '8005796'			
	WHERE CodArticulo = '8005634' AND DesArticulo = 'ALACENA MAYONESA 90CC 24DPK'

TRUNCATE TABLE NOTAS_CREDITO;

BULK INSERT NOTAS_CREDITO
FROM 'C:\Proyectos\Ecuador\CMI_SellOut_Ecuador\BaseDatos\BDPRUEBA.csv'
WITH (FIELDTERMINATOR=';', FIRSTROW=2, CODEPAGE='ACP');

UPDATE A SET CodArticulo = TRIM(CodArticulo) FROM NOTAS_CREDITO A;
UPDATE A SET Agencia = TRIM(Agencia) FROM NOTAS_CREDITO A;
UPDATE A SET DesArticulo = TRIM(DesArticulo) FROM NOTAS_CREDITO A;


UPDATE NOTAS_CREDITO
	SET	CodArticulo = '8005796'			
	WHERE CodArticulo = '8005634' AND DesArticulo = 'ALACENA MAYONESA 90CC 24DPK'

TRUNCATE TABLE TABLA_MATERIALES;

BULK INSERT TABLA_MATERIALES
FROM 'C:\Proyectos\Ecuador\CMI_SellOut_Ecuador\BaseDatos\MATERIALES_ALICORP.csv'
WITH (FIELDTERMINATOR=';',FIRSTROW=2,CODEPAGE='ACP');

--UPDATE A SET MaterialLaFabril = TRIM(MaterialLaFabril) FROM TABLA_MATERIALES A; EN CASO DE QUE ME PASEN MAS TENER EN CUENTA

UPDATE A
SET A.CodAlicorp = B.CodAlicorp
--SELECT *
FROM NOTAS_CREDITO A
LEFT JOIN TABLA_MATERIALES B ON A.CodArticulo = B.CodFabril AND A.DesArticulo = B.MaterialLaFabril;  


--UPDATE A
-- SET A.Clase_id = B.Clase_id
-- FROM TRASLADO A 
--	INNER JOIN Negocio$ B ON A.Negocio_id = B.Negocio_id 
-- CUANDO HACES UPDATE Y NO PONES WHERE O ALGUNA CONDICION FINAL, LE HACE EL UPDATE A TODO, Y DONDE NO ENCUENTRA LO PONE NULL
--EN MI CASO SE SUPONE QUE EL MAESTRO TIENE TODOS LOS CODIGOS, SI HAY LLAVES REPETIDAS AGARRA LA PRIMERA